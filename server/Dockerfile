FROM python:3.9-slim

WORKDIR /app

COPY . /app

RUN pip install --no-cache-dir -r requirements.txt

EXPOSE 5000

ENV FLASK_APP=run.py
ENV FLASK_ENV=production
ENV MONGO_DB=${MONGO_DB}
ENV MONGO_URI=${MONGO_URI}
ENV MONGO_USERNAME=${MONGO_USERNAME}
ENV MONGO_PASSWORD=${MONGO_PASSWORD}
ENV MONGO_TEST_DB=${MONGO_TEST_DB}
ENV MONGO_TEST_URI=${MONGO_TEST_URI}
ENV FIREBASE_CREDENTIALS=${FIREBASE_CREDENTIALS}
ENV REDIS_URL=${REDIS_URL}
ENV REDIS_HOST=${REDIS_HOST}
ENV REDIS_PASSWORD=${REDIS_PASSWORD}
ENV REDIS_PORT=${REDIS_PORT}

CMD ["flask", "run", "--host=0.0.0.0"]
